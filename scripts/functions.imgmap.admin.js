var easy2map_imgmap_functions=(function(){normaliseCSSElement=function(a){a=replaceAll(a,"_"," ");a=a.toLowerCase().replace(/\b[a-z]/g,function(b){return b.toUpperCase()});return a},refreshExampleMap=function(c){var b=parseInt(jQuery("#MapTemplateName").val());var a=!!jQuery("#photoSize").attr("proVersion");for(var d=0;d<$arrTemplates.length;d++){var e=$arrTemplates[d];if(parseInt(e.ID)==b){jQuery("#divPreview").html(replaceAll(e.TemplateHTML,"[siteurl]",$pluginsURL));if(a===true){jQuery("#easy2mapphotologo").remove()}jQuery("[id ^= styleElement]").each(function(){jQuery("#divMapParent").css(replaceAll(jQuery(this).attr("item"),"_","-"),jQuery(this).attr("value"))});jQuery("[id ^= stylePhotoElement]").each(function(){if(jQuery(this).attr("item")=="width"){jQuery("#divMapParent").css("width",jQuery(this).attr("value"));jQuery("#easy2mapmainimage").css("width","")}else{jQuery("#easy2mapmainimage").css(replaceAll(jQuery(this).attr("item"),"_","-"),jQuery(this).attr("value"))}});jQuery("[id ^= styleMapElement]").each(function(){jQuery("#divMap").css(replaceAll(jQuery(this).attr("item"),"_","-"),jQuery(this).attr("value"))});jQuery("#easy2mapIimgShadow").width(jQuery("#divMapParent").width());jQuery("#easy2mapIimgShadow").width(jQuery("#divMapParent").width());jQuery("#easy2mapIimgShadow").css("marginLeft",jQuery("#divMapParent").css("marginLeft"));jQuery("#easy2mapIimgShadow").css("marginRight",jQuery("#divMapParent").css("marginRight"))}}if(!!c){easy2map_imgmap_functions.saveMap(false,false)}easy2map_imgmap_functions.displayGoogleMap();google.maps.event.addDomListener(window,"load",easy2map_imgmappin_functions.retrieveMapPoints())};retrieveMapCSS=function(){var b=[];jQuery("[id ^= styleMapElement]").each(function(){var c=replaceAll(jQuery(this).attr("item"),"_","-");b[c]=jQuery(this).attr("value")});var a={formatOutput:true,rootTagName:"settings"};return jQuery.json2xml(b,a)};retrieveParentCSS=function(){var b=[];jQuery("[id ^= styleElement]").each(function(){var c=replaceAll(jQuery(this).attr("item"),"_","-");b[c]=jQuery(this).attr("value")});var a={formatOutput:true,rootTagName:"settings"};return jQuery.json2xml(b,a)};retrievePhotoCSS=function(){var b=[];jQuery("[id ^= stylePhotoElement]").each(function(){var c=replaceAll(jQuery(this).attr("item"),"_","-");b[c]=jQuery(this).attr("value")});var a={formatOutput:true,rootTagName:"settings"};return jQuery.json2xml(b,a)};retrieveMapOptions=function(h,f,b){var e=jQuery("#mapType").val().toUpperCase();if(e==="ROADMAP"){e=google.maps.MapTypeId.ROADMAP}else{if(e==="HYBRID"){e=google.maps.MapTypeId.HYBRID}else{if(e==="SATELLITE"){e=google.maps.MapTypeId.SATELLITE}else{if(e==="TERRAIN"){e=google.maps.MapTypeId.TERRAIN}else{e=google.maps.MapTypeId.ROADMAP}}}}var g=google.maps.MapTypeControlStyle.DEFAULT;var d=google.maps.ControlPosition.TOP_LEFT;var a=new google.maps.LatLng(h,f);var c={zoom:b,center:a,mapTypeId:e,mapTypeControl:false,clusterpins:false,trafficlayer:false,transitlayer:false,bicyclelayer:false,polyline_strokecolor:"000000",polyline_opacity:"1.0",polyline_strokeweight:"1",mapTypeControlOptions:{style:g,position:d},zoomControl:true,navigationControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.LEFT_TOP},scaleControl:false,scaleControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},streetViewControl:true,panControl:false,draggable:true};return c};retrieveMapTemplates=function(b,a){jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{mapID:b,action:"e2m_img_retrieve_map_templates"},success:function(d){$arrTemplates=d;for(var c=0;c<d.length;c++){jQuery("#MapTemplateName").append("<option value='"+d[c].ID+"'>"+d[c].TemplateName+"</option>")}jQuery("#MapTemplateName").val(a);if(jQuery("#MapTemplateName").val()==null){jQuery("#MapTemplateName").val(d[0].ID)}easy2map_imgmap_functions.changeMapTemplate()},error:function(c,e,d){alert(d)}})};hexToRgb=function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null};return{copyMapSettings:function(){if(!!jQuery("#CopyMapSettings").val()===false){return}jQuery("#CopyMapID").val(jQuery("#CopyMapSettings").val());document.getElementById("formCopymapSettings").submit()},changeElementValue:function(c,b,a){if(a==false){return}var d,e;if(b===1){d=jQuery("#styleElement"+c).attr("item");if(d=="box_shadow"){e=jQuery("#styleElement"+c).attr("value")}else{e=replaceAll(jQuery("#styleElement"+c).attr("value"),"px","")}}else{if(b===2){d=jQuery("#stylePhotoElement"+c).attr("item");if(d=="box_shadow"){e=jQuery("#stylePhotoElement"+c).attr("value")}else{e=replaceAll(jQuery("#stylePhotoElement"+c).attr("value"),"px","")}}else{d=jQuery("#styleMapElement"+c).attr("item");if(d=="box_shadow"){e=jQuery("#styleMapElement"+c).attr("value")}else{e=replaceAll(jQuery("#styleMapElement"+c).attr("value"),"px","")}}}$styleElementIndex=c;$styleSelectedElement=b;jQuery("div[id ^= div_edit_]").hide();switch(d){case"border_style":jQuery("#tdheading_style").html("Border Style");jQuery("#div_edit_style").modal();jQuery("#txtDefaultValue_style").val(e).focus();break;case"box_shadow":jQuery("#tdheading_style").html("Shadow Style");jQuery("#div_edit_shadow").modal();jQuery("#txtDefaultValue_shadow").val(e).focus();break;case"border_width":jQuery("#tdheading_pixel").html("Border Width");jQuery("#txtDefaultValue_pixel").find("option").remove();for(var c=parseInt(0);c<=parseInt(50);c++){jQuery("#txtDefaultValue_pixel").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_pixel").modal();jQuery("#txtDefaultValue_pixel").val(e).focus();break;case"width":if(e.indexOf("%")!=-1){jQuery("#tdheading_percentage").html("Width");jQuery("#txtDefaultValue_percentage").find("option").remove();for(var c=parseInt(1);c<=parseInt(110);c++){jQuery("#txtDefaultValue_percentage").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_percentage").modal();jQuery("#txtDefaultValue_percentage").val(replaceAll(e,"%","")).focus()}else{jQuery("#tdheading_pixel").html("Width");jQuery("#div_edit_pixel").modal();jQuery("#txtDefaultValue_pixel").val(e).focus()}break;case"height":jQuery("#tdheading_pixel").html("Height");jQuery("#txtDefaultValue_pixel").find("option").remove();for(var c=parseInt(10);c<=parseInt(2000);c++){jQuery("#txtDefaultValue_pixel").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_pixel").modal();jQuery("#txtDefaultValue_pixel").val(e).focus();break;case"margin_bottom":jQuery("#tdheading_margin").html("Bottom Margin");jQuery("#txtDefaultValue_margin").find("option").remove();jQuery("#txtDefaultValue_margin").append('<option value="auto">auto</option>');for(var c=parseInt(-50);c<=parseInt(500);c++){jQuery("#txtDefaultValue_margin").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_margin").modal();jQuery("#txtDefaultValue_margin").val(e).focus();break;case"margin_top":jQuery("#tdheading_margin").html("Top Margin");jQuery("#txtDefaultValue_margin").find("option").remove();jQuery("#txtDefaultValue_margin").append('<option value="auto">auto</option>');for(var c=parseInt(-50);c<=parseInt(500);c++){jQuery("#txtDefaultValue_margin").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_margin").modal();jQuery("#txtDefaultValue_margin").val(e).focus();break;case"margin_left":jQuery("#tdheading_margin").html("Left Margin");jQuery("#txtDefaultValue_margin").find("option").remove();jQuery("#txtDefaultValue_margin").append('<option value="auto">auto</option>');for(var c=parseInt(-50);c<=parseInt(500);c++){jQuery("#txtDefaultValue_margin").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_margin").modal();jQuery("#txtDefaultValue_margin").val(e).focus();break;case"margin_right":jQuery("#tdheading_margin").html("Right Margin");jQuery("#txtDefaultValue_margin").find("option").remove();jQuery("#txtDefaultValue_margin").append('<option value="auto">auto</option>');for(var c=parseInt(-50);c<=parseInt(500);c++){jQuery("#txtDefaultValue_margin").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_margin").modal();jQuery("#txtDefaultValue_margin").val(e).focus();break;case"border_radius":jQuery("#tdheading_pixel").html("Border Radius");jQuery("#txtDefaultValue_pixel").find("option").remove();for(var c=parseInt(0);c<=parseInt(500);c++){jQuery("#txtDefaultValue_pixel").append('<option value="'+c+'">'+c+"</option>")}jQuery("#div_edit_pixel").modal();jQuery("#txtDefaultValue_pixel").val(e).focus();break;case"border_color":jQuery("#tdheading_color").html("Border Color");jQuery("#div_edit_color").modal();jQuery("#txtDefaultValue_color").val(e).focus();jQuery("#txtDefaultValue_color").css("background-color",e);jQuery("#colourpicker").attr("data-color",hexToRgb(e));jQuery("#liDefaultValue_color").css("background-color",e);break;case"background_color":jQuery("#tdheading_color").html("Background Color");jQuery("#div_edit_color").modal();jQuery("#txtDefaultValue_color").val(e).focus();jQuery("#txtDefaultValue_color").css("background-color",e);jQuery("#colourpicker").attr("data-color",hexToRgb(e));jQuery("#liDefaultValue_color").css("background-color",e);break}},changeMapTemplate:function(){var e=jQuery("#MapTemplateName").val();jQuery("#divPreview").html("");var c=!!jQuery("#photoSize").attr("proVersion");for(var m=0;m<$arrTemplates.length;m++){var h=$arrTemplates[m];if(parseInt(h.ID)==e){jQuery("#MapTemplateExampleImg").attr("src",$pluginsURL+h.ExampleImage);var d=jQuery.xml2json(h.CSSValues);jQuery("#MapTemplateCSS").html("");var a=0;for(var l in d){jQuery("#MapTemplateCSS").append("<div "+(l==="width"||l==="height"?"style='display:none;'":"")+' class="cssStyleEditorParent"><a id="styleElement'+a+'" class="cssEdit" href="javascript:easy2map_imgmap_functions.changeElementValue('+a+", 1, "+c+');" item="'+l+'" value="'+d[l]+'">'+normaliseCSSElement(l)+" ("+d[l]+")</a></div>");a+=1}d=jQuery.xml2json(h.CSSValuesPhoto);jQuery("#MapTemplatePhotoCSS").html("");a=0;var k="",i="";for(var l in d){if(l==="width"){k=d[l]}if(l==="height"){i=d[l]}jQuery("#MapTemplatePhotoCSS").append("<div "+(l==="width"||l==="height"?"style='display:none;'":"")+' class="cssStyleEditorParent"><a id="stylePhotoElement'+a+'" class="cssEdit" href="javascript:easy2map_imgmap_functions.changeElementValue('+a+", 2, "+c+');" item="'+l+'" value="'+d[l]+'">'+normaliseCSSElement(l)+" ("+d[l]+")</a></div>");a+=1}jQuery("#photoSize").html("");jQuery("#photoSize").append("<option value='520px,390px'>520px x 390px</option>");jQuery("#photoSize").append("<option value='custom'>Set Custom Size</option>");jQuery("#photoSize").val(k+","+i).attr("selected","selected");if(jQuery("#photoSize option:selected").val()!=k+","+i){jQuery("#photoSize option:eq("+parseInt(jQuery("#photoSize option").length-2)+")").after("<option selected='selected' value='"+k+","+i+"'>"+k+" x "+i+"</option>")}d=jQuery.xml2json(h.CSSValuesMap);jQuery("#MapTemplateMapCSS").html("");a=0;var b="",f="";for(var l in d){if(l==="width"){b=d[l]}if(l==="height"){f=d[l]}jQuery("#MapTemplateMapCSS").append("<div "+(l==="width"||l==="height"?"style='display:none;'":"")+' class="cssStyleEditorParent"><a id="styleMapElement'+a+'" class="cssEdit" href="javascript:easy2map_imgmap_functions.changeElementValue('+a+", 3, "+c+');" item="'+l+'" value="'+d[l]+'">'+normaliseCSSElement(l)+" ("+d[l]+")</a></div>");a+=1}jQuery("#mapSize").html("");jQuery("#mapSize").append("<option value='custom'>Set Custom Size</option>");jQuery("#mapSize").val(b+","+f).attr("selected","selected");var g=b.length>0?b+" x "+f:"Height: "+f;if(jQuery("#mapSize option:selected").val()!=b+","+f){jQuery("#mapSize option:eq("+parseInt(jQuery("#mapSize option").length-2)+")").after("<option selected='selected' value='"+b+","+f+"'>"+g+"</option>")}}}refreshExampleMap(true)},disableHover:function(){jQuery("#easy2mapmainimage").unbind("mouseenter mouseleave")},displayGoogleMap:function(){var e=jQuery.xml2json($mapSettings.Settings);var h=e.lattitude;var d=e.longitude;var a=parseInt(e.zoom);if($map!=null){h=$map.getCenter().lat();d=$map.getCenter().lng();a=$map.getZoom()}var b=retrieveMapOptions(h,d,a);$map=new google.maps.Map(document.getElementById("divMap"),b);$overlay=new google.maps.OverlayView();$overlay.draw=function(){};$overlay.setMap($map);if(b.trafficlayer){var c=new google.maps.TrafficLayer();c.setMap($map)}if(b.transitlayer){var g=new google.maps.TransitLayer();g.setMap($map)}if(b.bicyclelayer){var f=new google.maps.BicyclingLayer();f.setMap($map)}},enableHover:function(){jQuery("#easy2mapslider").show();jQuery("#divMap").hover(function(){jQuery("#easy2mapslider").hide()});jQuery("#easy2mapmainimage").hover(function(){if(jQuery("#divMap:hover").length===0){jQuery("#easy2mapslider").fadeIn()}else{jQuery("#easy2mapslider").hide()}},function(){jQuery(this).find("#easy2mapslider").fadeOut()})},setCustomMapSize:function(){if(isNaN(document.getElementById("txtCustomMapWidthValue").value)){return}if(isNaN(document.getElementById("txtCustomMapHeightValue").value)){return}if(parseInt(document.getElementById("txtCustomMapWidthValue").value)<0){return}if(parseInt(document.getElementById("txtCustomMapHeightValue").value)<0){return}var b=jQuery("#txtCustomMapWidthValue").val().length===0?"":jQuery("#txtCustomMapWidthValue").val()+jQuery("#mapWidthDimension").val();var a=jQuery("#txtCustomMapHeightValue").val()+"px";easy2map_imgmap_functions.changeMapSize(b+","+a)},setCustomPhotoSize:function(){if(isNaN(document.getElementById("txtCustomPhotoWidthValue").value)){return}if(isNaN(document.getElementById("txtCustomPhotoHeightValue").value)){return}if(parseInt(document.getElementById("txtCustomPhotoWidthValue").value)<0){return}if(parseInt(document.getElementById("txtCustomPhotoHeightValue").value)<0){return}var b=jQuery("#txtCustomPhotoWidthValue").val()+jQuery("#photoWidthDimension").val();var a=jQuery("#txtCustomPhotoHeightValue").val()+"px";easy2map_imgmap_functions.changePhotoSize(b+","+a)},changeMapSize:function(b){if(b=="custom"){jQuery("#txtCustomMapWidthValue").val("").hide();jQuery("[id ^= styleMapElement]").each(function(){if(jQuery(this).attr("item")==="width"){var c=jQuery(this).attr("value");jQuery("#txtCustomMapWidthValue").val(parseInt(c));if(c.indexOf("px")>0){jQuery("#mapWidthDimension").val("px")}else{jQuery("#mapWidthDimension").val("%")}jQuery("#txtCustomMapWidthValue").val(parseInt(c)).show()}if(jQuery(this).attr("item")==="height"){jQuery("#txtCustomMapHeightValue").val(parseInt(jQuery(this).attr("value")))}});jQuery("#div_edit_mapwidthheight").modal();return}var a=b.split(",");if(a.length<2){return}jQuery("[id ^= styleMapElement]").each(function(){if(jQuery(this).attr("item")==="width"){jQuery(this).attr("value",a[0]);jQuery(this).html("Width ("+a[0]+")")}if(jQuery(this).attr("item")==="height"){jQuery(this).attr("value",a[1]);jQuery(this).html("Height ("+a[1]+")")}});jQuery("#mapSize").val(a[0]+","+a[1]).attr("selected","selected");if(jQuery("#mapSize option:selected").val()!=a[0]+","+a[1]){jQuery("#mapSize option:eq("+parseInt(jQuery("#mapSize option").length-2)+")").after("<option selected='selected' value='"+a[0]+","+a[1]+"'>"+a[0]+" x "+a[1]+"</option>")}refreshExampleMap(true)},changePhotoSize:function(b){if(b=="custom"){jQuery("[id ^= stylePhotoElement]").each(function(){if(jQuery(this).attr("item")==="width"){var c=jQuery(this).attr("value");if(c.indexOf("px")>0){jQuery("#photoWidthDimension").val("px")}else{jQuery("#photoWidthDimension").val("%")}jQuery("#txtCustomPhotoWidthValue").val(parseInt(c))}if(jQuery(this).attr("item")==="height"){jQuery("#txtCustomPhotoHeightValue").val(parseInt(jQuery(this).attr("value")))}});jQuery("#div_edit_photowidthheight").modal();return}var a=b.split(",");if(a.length<2){return}jQuery("[id ^= stylePhotoElement]").each(function(){if(jQuery(this).attr("item")==="width"){jQuery(this).attr("value",a[0]);jQuery(this).html("Width ("+a[0]+")")}if(jQuery(this).attr("item")==="height"){jQuery(this).attr("value",a[1]);jQuery(this).html("Height ("+a[1]+")")}});jQuery("#photoSize").val(a[0]+","+a[1]).attr("selected","selected");if(jQuery("#photoSize option:selected").val()!=a[0]+","+a[1]){jQuery("#photoSize option:eq("+parseInt(jQuery("#photoSize option").length-2)+")").after("<option selected='selected' value='"+a[0]+","+a[1]+"'>"+a[0]+" x "+a[1]+"</option>")}refreshExampleMap(true)},retrieveMapSettings:function(a){jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{mapID:a,action:"e2m_img_retrieve_map_settings"},success:function(c){$mapSettings=c;jQuery("#draggable").attr("src",$mapSettings.DefaultPinImage);var b=jQuery.xml2json($mapSettings.Settings);jQuery("#mapType").val(b.mapType);jQuery("#markerZoom").val(b.markerzoom);if($mapSettings.MapName){jQuery("#mapName").val($mapSettings.MapName);jQuery("#mapName2").html($mapSettings.MapName)}else{jQuery("#mapName2").html("Untitled Photo Map")}jQuery("#mapEditPencil").show();retrieveMapTemplates(a,$mapSettings.TemplateID)},error:function(b,d,c){alert(c)}})},saveItemValue:function(){var a;if($styleSelectedElement===1){a=jQuery("#styleElement"+$styleElementIndex).attr("item")}else{if($styleSelectedElement===2){a=jQuery("#stylePhotoElement"+$styleElementIndex).attr("item")}else{a=jQuery("#styleMapElement"+$styleElementIndex).attr("item")}}var b="";switch(a){case"border_style":b=jQuery("#txtDefaultValue_style").val();jQuery("#div_edit_style").hide();break;case"box_shadow":b=jQuery("#txtDefaultValue_shadow").val();jQuery("#div_edit_shadow").hide();break;case"border_width":b=jQuery("#txtDefaultValue_pixel").val()+"px";jQuery("#div_edit_pixel").hide();break;case"width":if(jQuery("#styleElement"+$styleElementIndex).attr("value").indexOf("%")!=-1){b=jQuery("#txtDefaultValue_percentage").val()+"%";jQuery("#div_edit_percentage").hide()}else{b=jQuery("#txtDefaultValue_pixel").val()+"px";jQuery("#div_edit_pixel").hide()}break;case"height":b=jQuery("#txtDefaultValue_pixel").val()+"px";jQuery("#div_edit_pixel").hide();break;case"margin_top":b=jQuery("#txtDefaultValue_margin").val();if(b!="auto"){b+="px"}jQuery("#div_edit_margin").hide();break;case"margin_bottom":b=jQuery("#txtDefaultValue_margin").val();if(b!="auto"){b+="px"}jQuery("#div_edit_margin").hide();break;case"margin_left":b=jQuery("#txtDefaultValue_margin").val();if(b!="auto"){b+="px"}jQuery("#div_edit_margin").hide();break;case"margin_right":b=jQuery("#txtDefaultValue_margin").val();if(b!="auto"){b+="px"}jQuery("#div_edit_margin").hide();break;case"border_color":b=jQuery("#txtDefaultValue_color").val();jQuery("#tdItemElementValue").css("background-Color",jQuery("#txtDefaultValue_color").val());jQuery("#div_edit_color").hide();break;case"background_color":b=jQuery("#txtDefaultValue_color").val();jQuery("#tdItemElementValue").css("background-Color",jQuery("#txtDefaultValue_color").val());jQuery("#div_edit_color").hide();break;case"z-index":b=jQuery("#txtDefaultValue_pixel").val();jQuery("#div_edit_pixel").hide();break;case"border_radius":b=jQuery("#txtDefaultValue_pixel").val()+"px";jQuery("#div_edit_pixel").hide();break}if($styleSelectedElement===1){jQuery("#styleElement"+$styleElementIndex).attr("value",b);jQuery("#styleElement"+$styleElementIndex).html(normaliseCSSElement(a)+" ("+b+")")}else{if($styleSelectedElement===2){jQuery("#stylePhotoElement"+$styleElementIndex).attr("value",b);jQuery("#stylePhotoElement"+$styleElementIndex).html(normaliseCSSElement(a)+" ("+b+")")}else{jQuery("#styleMapElement"+$styleElementIndex).attr("value",b);jQuery("#styleMapElement"+$styleElementIndex).html(normaliseCSSElement(a)+" ("+b+")")}}refreshExampleMap(true)},saveMap:function(f,h){var c=jQuery.xml2json($mapSettings.Settings);var b=c.lattitude;var e=c.longitude;var g=parseInt(c.zoom);if($map!=null){b=$map.getCenter().lat();e=$map.getCenter().lng();g=$map.getZoom()}var a={lattitude:b,longitude:e,zoom:g,markerzoom:jQuery("#markerZoom").val(),mapType:jQuery("#mapType").val(),backgroundColor:"FFFFFF",draggable:1,clusterpins:0,trafficlayer:0,transitlayer:0,bicyclelayer:0,scrollWheel:0,mapTypeControl:0,panControl:0,rotateControl:0,scaleControl:0,streetViewControl:1,zoomControl:1,mapTypeControl_style:"DROPDOWN_MENU",mapTypeControl_position:"TOP_RIGHT",panControl_position:"TOP_LEFT",rotateControl_position:"TOP_LEFT",scaleControl_position:"TOP_LEFT",streetViewControl_position:"TOP_LEFT",zoomControl_position:"TOP_LEFT",zoomControl_style:"SMALL",polyline_strokecolor:"000000",polyline_opacity:"1.0",polyline_strokeweight:"1"};var i={formatOutput:true,rootTagName:"settings"};jQuery("#divMap").html("");document.getElementById("easy2mapmainimage").style.backgroundImage="none";jQuery("#easy2mapslider").css("opacity","1.0");jQuery("#easy2mapslidertext").html("");var d=jQuery("#divPreview").html();jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{mapID:$mapID,mapName:jQuery("#mapName").val()==""?"Untitled Photo Map":jQuery("#mapName").val(),mapTemplateName:jQuery("#MapTemplateName").val(),action:"e2m_img_save_map",mapSettingsXML:jQuery.json2xml(a,i),parentCSSXML:encodeURIComponent(retrieveParentCSS()),photoCSSXML:encodeURIComponent(retrievePhotoCSS()),mapCSSXML:encodeURIComponent(retrieveMapCSS()),mapHTML:encodeURIComponent(d)},success:function(j){if(f){if(h){jQuery("#txtShortCode").val("[easy2mapimg id="+j+"]");jQuery("#mapShortCode").modal({keyboard:false});jQuery("#mapShortCode").on("shown",function(){document.getElementById("txtShortCode").focus();document.getElementById("txtShortCode").select()})}else{window.location="?page=easy2mapimg&action=viewmaps"}return}$mapID=j;jQuery("#formAddPinIcon").attr("action","?page=easy2mapimg&action=mappiniconsave&map_id="+$mapID);jQuery("#formAddPinImage").attr("action","?page=easy2mapimg&action=mappinimageupload&map_id="+$mapID)},error:function(j,l,k){alert(k)}})},saveMapName:function(){jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{mapID:$mapID,mapName:jQuery("#mapName").val()==""?"Untitled Photo Map":jQuery("#mapName").val(),action:"e2m_img_save_map_name"},error:function(a,c,b){alert(b)}})}}})();